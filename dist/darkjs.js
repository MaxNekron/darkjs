(()=>{"use strict";const t={attributes:!0,childList:!0,subtree:!0},e={load:function(t){"img"!=this.getTag()&&window.addEventListener("load",t.bind(this),!1)},modified:function(e){let s,n=function(){s||(setTimeout(e.bind(this),1),s=setTimeout((()=>{s=null}),1))}.bind(this);"undefined"!=typeof MutationObserver?new MutationObserver(n).observe(this,t):this.addEventListener("DOMSubtreeModified",n,!1)}};Element.prototype.setClass=function(t){return this.setAttribute("class",t||""),this},Element.prototype.getClass=function(){return this.getAttribute("class")||""},Element.prototype.hasClass=function(t){return!!this.getClass().match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},Element.prototype.addClass=function(t){return this.hasClass(t)||this.setClass((this.getClass()+" "+t).trim()),this},Element.prototype.removeClass=function(t){var e=new RegExp("(\\s|^)"+t+"(\\s|$)");return this.setClass(this.getClass().replace(e," ").trim()),this},Element.prototype.removeClassMatching=function(t){const e=this.getClass().match(new RegExp(t,"g"))||[];for(var s=0;s<e.length;s++)this.removeClass(e[s]);return this},Element.prototype.toHtml=function(){var t=document.createElement("div");return t.appendChild(this),t.innerHTML},Element.prototype.insert=function(t,e){return this.childNodes.length>0&&e<this.childNodes.length&&"bottom"!==e?("top"===e&&(e=0),this.insertBefore(t,this.childNodes[e])):this.appendChild(t),this},Element.prototype.before=function(t,e){var s=this.parentNode,n=Array.prototype.indexOf.call(s.childNodes,this)-1;return s.insert(t,n),this},Element.prototype.after=function(t,e){var s=this.parentNode,n=Array.prototype.indexOf.call(s.childNodes,this)+1;return s.insert(t,n)},Element.prototype.remove=function(){var t=this.parentNode;t&&t.removeChild(this)},Element.prototype.contains=function(t){return this==t||!!t&&this.contains(t.parentNode)},Element.prototype.setText=function(t){return this.innerText=t,this},Element.prototype.addText=function(t){return this.innerText=this.innerText+t,this},Element.prototype.setHtml=function(t){return this.innerHTML=t,this},Element.prototype.addText=function(t){return this.innerHTML=this.innerHTML+t,this},Element.prototype.getTag=function(){return this.tagName.toLowerCase()},Element.prototype.on=function(t,s,n){const o=e[t];return o&&o.bind(this)(s.bind(this)),this.addEventListener(t,s.bind(this),n),this},Window.prototype.on=Element.prototype.on,Element.prototype.styles=null,Element.prototype.addStyle=function(t,e){return this.style[t]=e,this},Element.prototype.setStyle=function(t){return this.setAttribute("style",t),this},Element.prototype.getStyle=function(t){return this.styles||(this.styles=window.getComputedStyle(this,null)),this.styles.getPropertyValue(t)},Element.prototype.getPath=function(){if(""!==this.id)return"#"+this.id;if(this===document.body)return this.getTag();for(var t=1,e=this.parentNode.childNodes,s=0;s<e.length;s++){var n=e[s];if(n===this)return this.parentNode.getPath()+" > "+this.getTag()+":nth-of-type("+t+")";1===n.nodeType&&n.getTag()===this.getTag()&&(t+=1)}};String.prototype.url_encode=function(){return encodeURIComponent(this)},String.prototype.url_decode=function(){return decodeURIComponent(this)},Object.prototype.toQueryString=function(){let t=[];return Object.keys(this).forEach((e=>{t.push([(e+"").url_encode(),(this[e]+"").url_encode()].join("="))})),t.join("&")},Object.prototype.fromQueryString=function(t){let e={};return t?(t.split("&").forEach((t=>{const s=t.split("=");e[s[0].url_decode()]=s[1].url_decode()})),e):e};const s=function(t,e){const s=Object.keys(e);for(let n=0;n<s.length;n++){const o=s[n];t=t.replace(new RegExp("{"+o+"}","g"),e[o])}return t.replace(new RegExp("{\\w+}","g"),"")};class n{constructor(t){const e=this.hsla(t);this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness,this.alpha=e.alpha}}function o(t){return new n(t)}function r(t,e){let s={};E.getStylesFromElement(t).forEach((function(t){/rgb/.test(t)&&!s[t]&&(s[t]=o(t))}));const n=t.children;for(var i=0;i<n.length;i++){const t=n[i];t.hasClass(e)||(s={...s,...r(t,e)})}return s}function i(t){return t.alpha>0}function a(t,e){return i(t)&&t.lightness<e}function l(t,e){return i(t)&&t.lightness>e}n.prototype.toString=function(){return this.toRgba()},n.prototype.toHexa=function(){this.hslToRgb(this.hue%360,this.saturation,this.lightness);var t=this.valToHex(255*this.alpha);return this.toHex()+t},n.prototype.toHex=function(){const t=this.hslToRgb(this.hue%360,this.saturation,this.lightness);return"#"+this.valToHex(t.red)+this.valToHex(t.green)+this.valToHex(t.blue)},n.prototype.toRgba=function(){const t=this.hslToRgb(this.hue%360,this.saturation,this.lightness);return"rgba("+Math.round(t.red)+", "+Math.round(t.green)+", "+Math.round(t.blue)+", "+this.alpha+")"},n.prototype.toHsl=function(){return"hsl("+(this.hue%360||0)+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%)"},n.prototype.valToHex=function(t){for(var e=parseInt(t).toString(16);e.length<2;)e="0"+e;return e},n.prototype.hslToRgb=function(t,e,s){var n,o;return t/=60,n=2*s-(o=s<=.5?s*(e+1):s+e-s*e),{red:255*this.hueToRgb(n,o,t+2),green:255*this.hueToRgb(n,o,t),blue:255*this.hueToRgb(n,o,t-2)}},n.prototype.hueToRgb=function(t,e,s){return s<0&&(s+=6),s>=6&&(s-=6),s<1?(e-t)*s+t:s<3?e:s<4?(e-t)*(4-s)+t:t},n.prototype.rgba=function(t){var e=1,s=t.replace(/[^\d\,\.]/g,"").split(",");return s[0]=(parseInt(s[0])||0)/255,s[1]=(parseInt(s[1])||0)/255,s[2]=(parseInt(s[2])||0)/255,void 0!==s[3]&&(e=parseFloat(s[3])),{red:s[0],green:s[1],blue:s[2],alpha:e}},n.prototype.hsla=function(t){const e=this.rgba(t);var s,n,o,r,i,a,l=[];for(l[0]=e.red,l[1]=e.green,l[2]=e.blue,s=l[0],n=l[0],i=0,o=0;o<l.length-1;o++)l[o+1]<=s&&(s=l[o+1]),l[o+1]>=n&&(n=l[o+1],i=o+1);return 0==i&&(a=(l[1]-l[2])/(n-s)),1==i&&(a=2+(l[2]-l[0])/(n-s)),2==i&&(a=4+(l[0]-l[1])/(n-s)),isNaN(a)&&(a=0),(a*=60)<0&&(a+=360),r=(s+n)/2,{hue:a,saturation:s==n?0:r<.5?(n-s)/(n+s):(n-s)/(2-n-s),lightness:r,alpha:e.alpha}};const h={colorsInElement:function(t,e,s,n){return function(t,e,s){let n={};return Object.keys(t).forEach((o=>{const r=t[o];(l(r,s)||a(r,e))&&(n[o]=r)})),n}(r(t,e),s,n)},invertBrightness:function(t,e=0){return t.lightness=1+e/100-t.lightness,t.lightness>1&&(t.lightness=1),t},isDark:a,isBright:l},c={"background-color":"bg",fill:"fl",stroke:"st",color:"cl","border-top-color":"bt","border-right-color":"br","border-bottom-color":"bb","border-left-color":"bl"},u={fill:["svg","path","rect","clippath","circle","elipse","line","polygon"],stroke:["svg"]},d={border:{test:"^0D+|none",props:["border-top-color","border-right-color","border-bottom-color","border-left-color"]}};function p(t){let e=Object.keys(c);const s=t.getTag();return Object.keys(d).forEach((s=>{const n=d[s],o=t.getStyle(s);new RegExp(n.test).test(o)&&(e=e.filter((t=>n.props.indexOf(t)<0)))})),Object.keys(u).forEach((t=>{u[t].indexOf(s)<0&&(e=e.filter((e=>e!=t)))})),e}function g(t,e,n){return s("{className}-{prop}-{level}",{className:n,level:e,prop:c[t]})}function f(t,e,n,r,i=0,a=!0){const l=function(t,e,n,r,i){const a=function(t){const e=t.replace(/^(\w+).*/i,"$1"),s=document.createElement(e);var n=t.replace(/\[[^\[\]]+\]/g,"").match(/#[\w-]+/),o=t.replace(/\[[^\[\]]+\]/g,"").match(/\.([\w\-]+)/g),r=t.match(/\[[^\[\]]+\]/g);return n&&(s.id=n.join("").replace("#","")),o&&s.setClass(o.join("").replace(/\./g," ").trim()),r&&r.forEach((t=>{var e=t.replace(/\[|\]/g,"").split("=");s.setAttribute(e[0],e.splice(1).join("="))})),s}("style[class="+n+"]");return i&&a.addText(s(".{className} { transition: all .2s ease !important; } \n",{className:n})),t.forEach(((t,i)=>{const l=h.invertBrightness(o(t),r);a.addText(function(t,e,n,o){let r="";return Object.keys(c).forEach((i=>{r+=function(t,e,n,o,r){return s("{path}.{className}.{styleClass}, {path}.{className} :not(.{className}) .{styleClass}:not(.{className}) { {prop}: {color} !important; } \n",{path:o,className:r,prop:t,color:e,styleClass:g(t,n,r)})}(i,t,e,n,o)})),r}(l,i+1,e,n))})),a}(r,n,e,i,a);t.insert(l,0)}function m(t,e,s,n,o,r,i){const a=Object.values(s);t.getTag(),p(t).forEach((o=>{const l=t.getStyle(o),c=s[l];if(c&&(n.indexOf(o)<0?h.isDark(c,r):h.isBright(c,i))){const s=a.indexOf(c);t.addClass(g(o,s+1,e))}}));const l=t.children;for(var c=0;c<l.length;c++){const t=l[c];0==t.hasClass(e)&&o.indexOf(t.getTag())<0&&m(t,e,s,n,o,r,i)}}function b(t,e){!function(t,e){const s=t.children;for(var n=0;n<s.length;n++){const t=s[n];"style"==t.getTag()&&t.className.match(e)&&t.remove()}}(t,e),y(t,e)}function y(t,e){t.removeClassMatching(e+"-[\\w-]+");const s=t.children||[];for(var n=0;n<s.length;n++){const t=s[n];0==t.hasClass(e)&&y(t,e)}}const E={getStylesFromElement:function(t){let e=[];return p(t).forEach((s=>{e.push(t.getStyle(s))})),e},addStylesToElement:function(t,e,s,n,o,r,i,a,l){t.addClass(e),b(t,e),f(t,e,t.getPath(),Object.keys(s),a,l),m(t,e,s,n,o,r,i)},removeStylesFromElement:b},v=class{constructor(t,e={}){this.root=t,this.animate=e.animate??!0,this.offset=e.offset??10,this.className=e.className||"darkjs",this.darkThreshold=e.darkThreshold??.3,this.brightThreshold=e.brightThreshold??.7,this.background_props=e.backgroundProps??["fill","background-color"],this.exclude_elements=e.exclude_elements??["style","script","img","text","video","audio"],this.isDark=!1,this.colors={},this.observer=new MutationObserver(this.onChange.bind(this)),this.observer.observe(this.root,{attributes:!0,childList:!0,subtree:!0})}darkem(t){this.colors={...this.colors,...h.colorsInElement(this.root,this.className,this.brightThreshold,this.darkThreshold)},E.addStylesToElement(this.root,this.className,this.colors,this.background_props,this.exclude_elements,this.darkThreshold,this.brightThreshold,this.offset,t??this.animate),this.isDark=!0}darkemnt(){this.isDark=!1,E.removeStylesFromElement(this.root,this.className),this.colors={}}toggle(){this.isDark?this.darkemnt():this.darkem()}onChange(t,e){let s=!1;for(const e of t)this.isOwnMutation(e.target)&&(s=!0);!this.isDark||this.isMutating||s||(this.isMutating=!0,this.darkem(!1),setTimeout((()=>this.isMutating=!1),1))}isOwnMutation(t){return t!=this.root&&(t.hasClass(this.className)||this.isOwnMutation(t.parentNode))}};if(!window.Darkjs){window.Darkjs=v;let t={};document.querySelectorAll("script").forEach((e=>{/darkjs\.js\?/.test(e.src)&&(t={...t,...{}.fromQueryString(e.src.split("?").pop())})})),window.Darkjs.callback=window[t.callback],window.Darkjs.options=t,window.Darkjs.callback||(window.Darkjs.callback=function(){window.addEventListener("load",(function(){document.body.darkjs=new v(document.body,window.Darkjs.options),document.body.darkjs.darkem()}))}),window.Darkjs.callback()}})();